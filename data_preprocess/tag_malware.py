import csv
import os
from os import walk

malware = {} # dictionary

def build_malware_set(file_name):
    f = open(file_name, 'r')
    reader = csv.reader(f)
    for row in reader:
       malware[row[0]] = row[1]
    f.close()


def tag_the_malware(filename, newfilename):
    print "Tag " + filename + ", please wait..."

    with open(filename, 'rb') as input, open(newfilename, 'wb') as out:
        writer = csv.writer(out)
        for row in csv.reader(input):
            if row[0] in malware:
                writer.writerow(row + [malware.get(row[0])] )
            else:
                print row[0] + "not in training-set.csv" # for error check
                writer.writerow(row + ['unknown'] )
    print "Done.\n"


def main( ):
    os.chdir("/Users/andy/TbrainGame")

    build_malware_set( os.getcwd() + "/new-training-set.csv")

    # for key, value in malware.items():
    #     print key +" " + value

    #tag_the_malware(os.getcwd()+"/training-data/0301.csv", os.getcwd()+"/tag-training-data/0301.csv")

    for root, dirs, files in walk(os.getcwd()+"/training-data/"):
        for f in files:
            if f != ".DS_Store":
                tag_the_malware(os.getcwd()+"/training-data/"+f , os.getcwd()+"/tag-training-data/"+ f)
                # mypathfile = mypath + f
                # newpathfile = newpath + f
                # print mypathfile +"\n"+ newpathfile
                #tag_the_malware(mypathfile, newpathfile)


if __name__ == "__main__":
    main()

